<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <title>api-navigation test</title>
    <script src="../../webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../../web-component-tester/browser.js"></script>
    <link rel="import" href="../api-navigation.html">
    <link rel="import" href="../../arc-polyfills/arc-polyfills.html">
    <link rel="import" href="../../iron-test-helpers/mock-interactions.html">
    <script src="amf-loader.js"></script>
  </head>
  <body>

    <test-fixture id="Basic">
      <template>
        <api-navigation></api-navigation>
      </template>
    </test-fixture>

    <script>
      /* global AmfLoader */
      suite('Documentation fragment', () => {
        [
          ['Regular model', false],
          ['Compact model', true]
        ].forEach((item) => {
          suite(item[0], () => {
            let element;
            suiteSetup(() => {
              return AmfLoader.load(item[1], 'documentation-fragment')
              .then((model) => {
                element = fixture('Basic');
                element.amfModel = model;
              });
            });
            test('Collects documentaion information', () => {
              const result = element.docs;
              assert.lengthOf(result, 1);
              assert.typeOf(result[0].id, 'string');
              assert.equal(result[0].label, 'About');
            });

            test('Documentation is opened', () => {
              assert.isTrue(element.docsOpened);
            });

            test('_isFragment is set', () => {
              assert.isTrue(element._isFragment);
            });

            test('_renderSummary is false', () => {
              assert.isFalse(element._renderSummary);
            });

            test('summary is not rendered', () => {
              flush(() => {
                const panel = element.shadowRoot.querySelector('.summary');
                assert.notOk(panel);
              });
            });

            test('Types is undefined', () => {
              assert.isUndefined(element.types);
            });

            test('Security is undefined', () => {
              assert.isUndefined(element.security);
            });

            test('Endpoints is undefined', () => {
              assert.isUndefined(element.endpoints);
            });
          });
        });
      });
    </script>

  </body>
</html>
