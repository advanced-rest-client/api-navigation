<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <title>api-navigation test</title>

    <script src="../../../@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../../../@polymer/test-fixture/test-fixture.js"></script>
    <script src="../../../mocha/mocha.js"></script>
    <script src="../../../chai/chai.js"></script>
    <script src="../../../wct-mocha/wct-mocha.js"></script>

    <script type="module" src="../api-navigation.js"></script>
    <script src="./amf-loader.js"></script>
  </head>
  <body>

    <test-fixture id="Basic">
      <template>
        <api-navigation></api-navigation>
      </template>
    </test-fixture>

    <script type="module">
    /* global AmfLoader */
    suite('Type fragment', () => {
      [
        ['Regular model', false],
        ['Compact model', true]
      ].forEach((item) => {
        suite(item[0], () => {
          let element;
          suiteSetup(() => {
            return AmfLoader.load(item[1], 'type-fragment')
            .then((model) => {
              element = fixture('Basic');
              element.amfModel = model;
            });
          });

          test('Documentaion is undefined', () => {
            assert.isUndefined(element.docs);
          });

          test('Types is computed', () => {
            const result = element.types;
            assert.lengthOf(result, 1);
            assert.typeOf(result[0].id, 'string');
            assert.equal(result[0].label, 'A person resource');
          });

          test('Security is undefined', () => {
            assert.isUndefined(element.security);
          });

          test('Endpoints is undefined', () => {
            assert.isUndefined(element.endpoints);
          });

          test('Types is opened', () => {
            assert.isTrue(element.typesOpened);
          });

          test('_isFragment is set', () => {
            assert.isTrue(element._isFragment);
          });

          test('_renderSummary is false', () => {
            assert.isFalse(element._renderSummary);
          });

          test('summary is not rendered', () => {
            flush(() => {
              const panel = element.shadowRoot.querySelector('.summary');
              assert.notOk(panel);
            });
          });
        });
      });
    });
    </script>

  </body>
</html>
